# 要件定義書

## 背景

エンターテイメントの一つにライブ配信がある。そこでは「ライブ配信=動画の生配信」といってもおかしくないほど、配信するメディアが動画に一本化している。しかし、そこに一歩踏み込んで「ライブ配信=動画の生配信」という固定観念を取り払えば、ユーザとプレゼンタ間でより強い関わり方ができるのではないかと考えた。

## 課題

現在の「ライブ配信」における課題は、下記のとおりである。

- コミュニケーションの手段が少なく、一方的な傾向にある。
	- もっとも一般的な形は、配信者が視聴者のコメントを読み上げることである。
- 動画というメディアに制限される以上、できることが制限されてしまう。

## 目的・方針

上記の課題を解決するとともに技術力の向上を図り、下記の方針を設定する。

- 動画ではない、独自の方法を用いた配信を行う。
- ユーザとプレゼンタ間の距離を縮めるための、インタラクティブ(双方向的)なコミュニケーションを提供する。
- 様々な技術を用いて、新しいことに挑戦する。
	- VR
	- AR(追加機能として実装予定)
	- ネットワークによる通信
	- 既存AI

## 概要

1人のキャラクターが3Dの仮想空間上でライブ配信を行うシステムである。  
従来のライブ配信サービスとは異なる、インタラクティブなコミュニケーションを提供する。具体的には、送ったプレゼントをステージに出現させたり、キャラクターと一緒にミニゲームをして楽しんだりできる。

なお、既存のサービスを参考にして制作するが、クロスプラットフォーム対応などの独自機能の実装も検討している。  
参考動画: [ゲームでとことん盛り上がろう！ - YouTube](https://www.youtube.com/watch?v=uVFd-auui0M)

## 用語定義

別ファイル`terms.md`からの抜粋。

### ライブ要素

- ライブ: 本システム上で実施する生放送。
- ステージ: プレゼンタがライブをする空間。
- エール: ユーザがライブで送れるオブジェクト。
	- 出現情報: 出現するエールの種類、位置、贈ったユーザなどの情報。
- ランキングボード: ミニゲームで好成績を収めたユーザを掲載するボード。
- アスタメモリ: エールを贈ったりミニゲームをしたりして獲得できるポイント。
- エメトストーン: エールを贈るのに必要な通貨。有償で入手する想定。

### アクター

- 運営: サービスを提供する側の人物または組織。具体的にはプレゼンタとサポータなど。
- ユーザ: サービスの利用者。
- メインアプリ: サーバ、クライアント、コントローラの総称。

#### 運営

- サーバ: システムの中心となるアプリケーション。
- プレゼンタ: コントローラを使ってユーザとコミュニケーションをとったりする人物。
- コントローラ: アバターの位置や状態を操作するアプリケーション。
- サポータ: コンソールを使ってプレゼンタを補助する人物。
- コンソール: ライブを制御するために、サーバに指示を出すアプリケーション。

#### ユーザ

- クライアント: ユーザが操作するアプリケーション。

### その他

- シグナル: コンソールからサーバに送信される、ライブ制御用の命令。

## 機能要件

工程の番号順に段階的に実装する。

### アバター表示機能

サーバとクライアントでアバターの位置と姿勢を同期し、クライアント上に表示できる。また、プレゼンタの音声をクライアント上で再生できる。

### コメント機能

クライアントからコメントを送信できる。また、送信したコメントをコントローラとすべてのクライアント上に表示できる。コメントは事前に設定されたユーザ名とともに表示される。

### エール送信機能

クライアントからエールを贈れる。また、贈ったエールをステージ上に出現させられる。出現したエールは物理演算に基づいて移動または回転し、プレゼンタがコントローラで掴んでも移動できる。

### ライブ制御機能

コンソールからシグナルを送信し、ライブを制御できる。具体的には、ライブの開始と終了やミニゲームの進行を命令する。

### アスタメモリ管理機能

エールを贈ったりミニゲームで好成績を収めたりしてアスタメモリを獲得できる。また、獲得したアスタメモリの累計をクライアント上に表示できる。

### ミニゲーム機能

じゃんけんなどのミニゲームを配信できる。ゲーム後にはランキングボードが出現し、好成績者のユーザ名が掲載される。

### ランキング機能

獲得したアスタメモリの累計をもとに、ユーザ全員の間における順位を表示できる。

### コメントレベル機能

獲得したアスタメモリの累計をもとに、コメントの色や大きさを変更できる。

### スクリーンショット機能

スクリーンショットを撮影し、端末に保存できる。

### 通話対戦機能

プレゼンタと抽選で選ばれたユーザが1対1でターン制のゲームで対戦できる。対戦中はお互いに音声を通じて会話できる。

### 着せ替え機能

プレゼンタを選んだ3Dモデルに着せ替えることができる。着せ替えた結果はそのクライアントのみに反映される。

## 非機能要件

連続稼働時間は1時間、最大同時接続数は100人を保証する。  
サーバは、オンプレミスでの稼働を保証する。また、個人のPCを使ってインターネットを経由した配信もできる。

## 技術要件

### 開発環境

#### 共通

- OS: Windows 10
- IDE: Visual Studio 2022
- 言語: C#

#### メインアプリ

- ゲームエンジン: Unity 2021.3.9f1
- バージョン管理システム: Unity Plastic SCM

#### コンソール

- UIフレームワーク: WinUI 3
- バージョン管理システム: Git

### 外部ソフト/サービス

- [Pose AI](https://www.poseai.co.uk/): 姿勢のトラッキング
- [Vivox](https://unity.com/ja/products/vivox): プレゼンタの音声のストリーミング
- [Netcode for GameObjects](https://unity.com/ja/products/netcode): メインアプリ間の通信

## システム化の範囲

参考サービスのうち、ライブ配信の機能のみを実装する。つまり、見逃し配信、個別メッセージ、月間ランキング、実績といった機能は実装しない。また、オマケトークの機能も実装しない。加えて、有償通貨を購入する際の支払処理はスキップする。

## システム構成

![システム構成図](../systemConfiguration/systemConfiguration.png)

## 工程計画

- 2022-10-07: 要件定義書完成
- 2022-xx-xx: 行程x完了
- 2022-12-16: 中間発表
- 2023-02-24以降: 発表予定

## 成果物

- 各種設計書
- アセット/ソースファイル一式
	- Unityのプロジェクトフォルダ
	- コンソールのソリューションフォルダ
- 各プラットフォーム向けの実行ファイル
- 運用マニュアル

